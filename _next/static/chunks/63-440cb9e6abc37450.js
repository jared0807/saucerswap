"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[63],{60224:function(e,t,n){n.d(t,{DF:function(){return P},H2:function(){return C},bl:function(){return Z},hK:function(){return x},jg:function(){return q}});var a=n(85893),o=n(67294),r=n(11163),u=n(39499),i=n.n(u),d=n(65074),l=n(47205),s=n(22238),c=n(38827),p=n(53342),f=n(89204),k=n(17210),y=n(618),v=n(44626),h=n(89980),m=n(4002),g=n(91402),A=n(47808),S=n(20243),T=n(37176);let I={activeA:!0,tokenIdA:k.tC,tokenIdB:y.vj,valueAString:"",valueBString:"",displayCurrency:"USD"},x=(0,o.createContext)({supplyState:I,supplyDispatch:()=>{},supplyDerivedState:{tokenA:d.k3,tokenB:d.k3,valueA:g.ih.fromRawAmount(d.k3,0),valueB:g.ih.fromRawAmount(d.k3,0),finalAValue:g.ih.fromRawAmount(d.k3,0),finalBValue:g.ih.fromRawAmount(d.k3,0),pool:void 0,isLoadingPool:!0}});t.ZP=function(e){let{children:t,initialState:n}=e,[r,u]=(0,o.useReducer)((e,t)=>{switch(t.type){case"resetSupply":return I;case"updateSupply":return Object.assign({},e,t.payload);default:return e}},{...I,...n}),{tokenIdA:l,tokenIdB:s,valueAString:c,valueBString:p,activeA:y}=r,{data:v=d.k3}=(0,d.ZP)(l,void 0,!1),{data:h=d.Pg}=(0,d.ZP)(s,void 0,!1),{data:A=d.k3}=(0,d.ZP)((0,k.zo)().address),S=(0,m.nq)(v.decimals,c),T=(0,m.nq)(h.decimals,p),C=(0,k.F$)(v.address)?A||d.k3:v,Z=(0,k.F$)(h.address)?A||d.k3:h,q=g.ih.fromRawAmount(C,S),P=g.ih.fromRawAmount(Z,T),B=(0,k.F$)(l)?k.tC:l,b=(0,k.F$)(s)?k.tC:s,{data:w,isLoading:E}=(0,f.ZP)(B,b),N=q;if(w&&!y&&i().lessThan(q.numerator,g.Bz))try{N=(C.equals(w.token0)?w.token1Price:w.token0Price).quote(P)}catch(e){}let R=P;if(w&&y&&i().lessThan(P.numerator,g.Bz))try{R=(Z.equals(w.token1)?w.token0Price:w.token1Price).quote(q)}catch(e){}let j={tokenA:C,tokenB:Z,valueA:q,valueB:P,pool:w,isLoadingPool:E,finalAValue:N,finalBValue:R};return(0,a.jsx)(x.Provider,{value:{supplyState:r,supplyDispatch:u,supplyDerivedState:j},children:t})};let C=(e,t,n,a)=>{Z(t,n,a);let{supplyState:r,supplyDerivedState:u}=(0,o.useContext)(x),{activeA:l,tokenIdA:p,tokenIdB:f,valueAString:k,valueBString:y}=r,{tokenA:v,tokenB:m,finalAValue:g,finalBValue:T}=u,{data:I}=(0,c.Z)(v.address),{data:C}=(0,c.Z)(m.address),q=(0,h.Z)([I,C]),P=[I,C].filter(e=>{var t,n,a,o;return!!((null==e?void 0:null===(n=e.custom_fees)||void 0===n?void 0:null===(t=n.fixed_fees)||void 0===t?void 0:t.length)||(null==e?void 0:null===(o=e.custom_fees)||void 0===o?void 0:null===(a=o.fractional_fees)||void 0===a?void 0:a.length))}),{data:B}=(0,s.Z)(p),{data:b}=(0,s.Z)(f),w=e&&!l?y?g.toExact():"":k,E=e&&l?k?T.toExact():"":y,N=(null==e?void 0:e.liquidityAmount)?e.liquidityAmount:d.xy,R=i().greaterThan(g.quotient,A.xE)&&i().greaterThan(T.quotient,A.xE)?new S.sO(0,"",g,T,N):void 0,j=!g.greaterThan("0")&&"Missing ".concat(v.symbol," value")||!T.greaterThan("0")&&"Missing ".concat(m.symbol," value")||g.greaterThan(B)&&"Insufficient ".concat(v.symbol?"".concat(v.symbol):"balance")||T.greaterThan(b)&&"Insufficient ".concat(m.symbol?"".concat(m.symbol):"balance")||"";return{finalAString:w,finalBString:E,balanceA:B,balanceB:b,supplyPool:R,valueErrorMessage:j,keyedTokens:q,feeOnTransferTokens:P}},Z=(e,t,n)=>{let{supplyDispatch:a}=(0,o.useContext)(x),{data:u=[]}=(0,p.ZP)(),i=(0,r.useRouter)();(0,o.useEffect)(()=>{let o=u.find(t=>t.contractId===e);if(o)a({type:"updateSupply",payload:{tokenIdA:o.token0.address,tokenIdB:o.token1.address}});else if(t&&n){let e=(0,v.r)(t),o=(0,v.r)(n),r=u.find(t=>{let{token0:n,token1:a}=t;return[n.address,a.address].includes(e)&&[n.address,a.address].includes(o)});if(a({type:"updateSupply",payload:{tokenIdA:e,tokenIdB:o}}),r){let e="/liquidity/".concat(r.contractId,"/manage-position");i.replace(e)}}},[t,n,a])},q=()=>{let{poolContractId:e=""}=(0,r.useRouter)().query,t=(0,T.Z)(e),{supplyState:n,supplyDispatch:a,supplyDerivedState:u}=(0,o.useContext)(x),{data:i=[]}=(0,p.ZP)(),{setNavigateable:d}=(0,l.tw)(),{createTokenChangeHandler:s,createValueChangeHandler:c}=P(),{activeA:f,valueAString:k,valueBString:y,tokenIdA:v,tokenIdB:h}=n,{tokenA:m,tokenB:g}=u,A=async()=>{a({type:"updateSupply",payload:{valueAString:"",valueBString:""}}),"-1"===t&&d(!0)},S=()=>{a({type:"updateSupply",payload:{activeA:!f,tokenIdA:h,tokenIdB:v,valueAString:y,valueBString:k}})},I=s({isTokenA:!0,comparedToken:g,existingPools:i,hrefPath:"/manage-position",onAddressMatchCB:S});return{handleTokenAChange:I,handleTokenBChange:s({isTokenA:!1,comparedToken:m,existingPools:i,hrefPath:"/manage-position",onAddressMatchCB:S}),handleValueAChange:c(!0,"valueAString"),handleValueBChange:c(!1,"valueBString"),handleSupplySetNavigateable:A}},P=()=>{let e=(0,r.useRouter)(),{supplyDispatch:t}=(0,o.useContext)(x);return{handleSupply:async()=>t({type:"updateSupply",payload:{valueAString:"",valueBString:""}}),createValueChangeHandler:(e,n)=>async a=>{t({type:"updateSupply",payload:{activeA:e,[n]:a}})},createTokenChangeHandler:n=>{let{isTokenA:a,comparedToken:o,existingPools:r,hrefPath:u="",onAddressMatchCB:i}=n;return async n=>{let{address:d}=n;d===o.address&&i&&i();let l=r.find(e=>{let{token0:t,token1:n}=e;return[t.address,n.address].includes(d)&&[t.address,n.address].includes(o.address)}),s=(e,t)=>{let n=e?t:o.address;return y.D2===n?"HBAR":n},c=s(a,d),p=s(!a,d),f=l?"/liquidity/".concat(l.contractId).concat(u):"/liquidity/-1/manage-position/?tokenIdA=".concat(c,"&tokenIdB=").concat(p);e.replace(f),t({type:"updateSupply",payload:{activeA:a,[a?"tokenIdA":"tokenIdB"]:d}})}}}}},80482:function(e,t,n){n.d(t,{Kf:function(){return p},Uc:function(){return f}});var a=n(85893),o=n(67294),r=n(91402),u=n(65074),i=n(75480),d=n(47892),l=n(47808),s=n(63046);let c={percent:l.xE},p=(0,o.createContext)({burnState:c,burnDispatch:()=>{},burnDerivedState:{}});function f(e,t){let{tokenIdA:n,tokenIdB:a,fee:l}=e,{data:c=u.k3}=(0,u.ZP)(n),{data:p=u.k3}=(0,u.ZP)(a),{data:f}=(0,d.BR)(n,a,l),k=(0,o.useMemo)(()=>f&&e.liquidity&&"number"==typeof e.tickLower&&"number"==typeof e.tickUpper?new s.L({tokenSN:e.tokenSN,nftTokenId:e.nftTokenId,accountId:e.accountId,pool:f,liquidity:e.liquidity,tickLower:e.tickLower,tickUpper:e.tickUpper}):void 0,[f,e]),y=new r.gG(t,100),v=k?y.multiply(k.amount0Rounded.quotient).quotient:void 0,h=k?y.multiply(k.amount1Rounded.quotient).quotient:void 0,m=c.address===(null==f?void 0:f.token0.address)?c:p,g=c.address===(null==f?void 0:f.token0.address)?p:c,A=m&&v?r.ih.fromRawAmount(m,v):void 0,S=g&&h?r.ih.fromRawAmount(g,h):void 0,T=c.address===(null==f?void 0:f.token0.address)?A:S,I=c.address===(null==f?void 0:f.token0.address)?S:A,{data:{feeValue0:x,feeValue1:C}}=(0,i.ki)(e.tokenSN,e.nftTokenId);return{position:k,liquidityPercentage:y,liquidityValue0:A,liquidityValue1:S,liquidityValueA:T,liquidityValueB:I,feeValueA:c.address===(null==f?void 0:f.token0.address)?x:C,feeValueB:c.address===(null==f?void 0:f.token0.address)?C:x,feeValue0:x,feeValue1:C,outOfRange:!!f&&(f.tickCurrent<e.tickLower||f.tickCurrent>e.tickUpper)}}t.ZP=function(e){let{children:t,initialState:n}=e,[r,u]=(0,o.useReducer)((e,t)=>{switch(t.type){case"resetBurn":return c;case"updateBurn":return Object.assign({},e,t.payload);default:return e}},{...c,...n}),{percent:i}=r;return(0,a.jsx)(p.Provider,{value:{burnState:r,burnDispatch:u,burnDerivedState:{}},children:t})}},89980:function(e,t){let n=["kyc_key","freeze_key","pause_key","wipe_key"];t.Z=e=>e.map(e=>{let t=n.filter(t=>!!(null==e?void 0:e[t]));return{token:e,keys:t}}).filter(e=>e.keys.length>0)},47205:function(e,t,n){n.d(t,{ql:function(){return k},tw:function(){return h},u:function(){return v}});var a=n(85893),o=n(91966),r=n.n(o),u=n(70735),i=n.n(u),d=n(11163),l=n(67294),s=n(37176),c=n(72833),p=n(31969),f=n(3705);let k=e=>{let[t,n]=(0,l.useState)(!1),{hbarAddress:a}=(0,c.O)(),{data:o=[]}=(0,f.ZP)(a),r=o.map(e=>({tokenSN:e.tokenSN,nftTokenId:e.nftTokenId})),u=(0,s.Z)(r),p=(0,d.useRouter)(),{poolContractId:k}=p.query;return(0,l.useEffect)(()=>{let e=i()(r,u||[],e=>e.tokenSN+"/"+e.nftTokenId);t&&1===e.length&&(console.debug("NEW POSITION DETECTED, NAVIGATING TO IT","/liquidity/".concat(k,"/my-positions/").concat(e[0].tokenSN,"?positionNftTokenId=").concat(e[0].nftTokenId)),p.replace("/liquidity/".concat(k,"/my-positions/").concat(e[0].tokenSN,"?positionNftTokenId=").concat(e[0].nftTokenId)).then(()=>{n(!1)}))},[u,r,t,p,k]),(0,l.useEffect)(()=>{if(t){let t=setTimeout(()=>{n(!1),e&&e()},2e4);return()=>clearTimeout(t)}},[t]),{navigateable:t,setNavigateable:n}},y=(0,l.createContext)({navigateable:!1,setNavigateable:()=>{}}),v=e=>{let{children:t}=e,[n,o]=(0,l.useState)(!1),{hbarAddress:u}=(0,c.O)(),{data:i=[]}=(0,p.Z)(u,!1),f=i.map(e=>e.pool.contractId),k=(0,s.Z)(f),v=(0,d.useRouter)(),{poolContractId:h}=v.query;return(0,l.useEffect)(()=>{if(!k)return;let e=r()(f,k);n&&1===e.length&&(console.debug("NEW POOL CREATION DETECTED, NAVIGATING TO STATISTICS","/liquidity/".concat(e[0])),v.replace("/liquidity/".concat(e[0])).then(()=>{o(!1)}))},[k,f,n,v,h]),(0,l.useEffect)(()=>{if(n){let e=setTimeout(()=>{o(!1)},1e4);return()=>clearTimeout(e)}},[n]),(0,a.jsx)(y.Provider,{value:{navigateable:n,setNavigateable:o},children:t})},h=()=>{let{navigateable:e,setNavigateable:t}=(0,l.useContext)(y);return{navigateable:e,setNavigateable:t}}},29063:function(e,t,n){n.d(t,{E:function(){return c}});var a=n(85893),o=n(2734),r=n(65582),u=n(90629),i=n(60224),d=n(80482),l=n(67068),s=n(47205);let c=e=>{let{children:t,innerPaperProps:n,...o}=e;return(0,a.jsx)(u.Z,{className:"transparent",...o,sx:{"&.MuiPaper-root":{backdropFilter:"none"},p:{xs:0,sm:4},...null==o?void 0:o.sx},children:(0,a.jsx)(u.Z,{variant:"outlined",...n,sx:{backgroundColor:"custom.topBgLayer",p:{xs:2.5,sm:12},display:"flex",justifyContent:"center",...null==n?void 0:n.sx},children:t})})};t.Z=e=>{let{children:t,sx:n}=e;return(0,o.Z)(),(0,a.jsx)(l.ZP,{children:(0,a.jsx)(d.ZP,{children:(0,a.jsx)(i.ZP,{children:(0,a.jsx)(s.u,{children:(0,a.jsx)(r.Z,{sx:{maxWidth:1200,pt:{xs:4,sm:8},pb:{xs:32,sm:30},...n},children:(0,a.jsx)(c,{children:t})})})})})})}},44626:function(e,t,n){n.d(t,{r:function(){return r}});var a=n(65074),o=n(17210);let r=e=>"HBAR"!==e&&(0,o.wu)(e)?e:a.k3.address}}]);